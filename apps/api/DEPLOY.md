# Инструкции по деплою

## Создание администратора после деплоя

После обновления через GitHub и настройки базы данных на сервере, выполните следующие шаги:

### 1. Подключитесь к серверу

```bash
ssh user@your-server
cd /path/to/project/apps/api
```

### 2. Установите зависимости (если нужно)

```bash
npm install
```

### 3. Примените миграции базы данных (если нужно)

```bash
npm run prisma:migrate
```

### 4. Создайте администратора

```bash
npm run create-admin-eterno
```

Или напрямую:

```bash
node create-admin-eterno.js
```

### Данные для входа

После успешного выполнения скрипта используйте следующие данные:

- **Email:** `admineterno@yandex.ru`
- **Пароль:** `Adm!n3t3rn0#2024$Secure`
- **Роль:** `SUPER_ADMIN`

⚠️ **ВАЖНО:** Сохраните эти данные в безопасном месте!

### Проверка

После создания администратора вы сможете войти в админ-панель используя указанные email и пароль.

## Альтернативный способ (через Prisma Studio)

Если скрипт не работает, можно создать администратора через Prisma Studio:

```bash
npm run prisma:studio
```

Затем в открывшемся интерфейсе:
1. Откройте таблицу `User`
2. Нажмите "Add record"
3. Заполните поля:
   - email: `admineterno@yandex.ru`
   - passwordHash: (используйте bcrypt для хеширования пароля)
   - firstName: `Администратор`
   - lastName: `Eterno`
   - role: `SUPER_ADMIN`
   - isActive: `true`

## Устранение проблем

### Ошибка подключения к базе данных

Убедитесь, что:
1. База данных запущена и доступна
2. Переменные окружения настроены правильно (файл `.env`)
3. `DATABASE_URL` указывает на правильную базу данных

### Ошибка "Таблица users не существует"

Выполните миграции:
```bash
npm run prisma:migrate
```

### Пользователь уже существует

Скрипт автоматически обновит существующего пользователя с таким email, установив новый пароль и роль SUPER_ADMIN.
