#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SQLite –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

echo "üîÑ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SQLite –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö..."

# –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –ø–∞–ø–∫—É –º–∏–≥—Ä–∞—Ü–∏–π PostgreSQL
if [ -d "prisma/migrations" ]; then
    echo "üì¶ –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ PostgreSQL..."
    rm -rf prisma/migrations
fi

# –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –µ—Å—Ç—å)
if [ -f "dev.db" ]; then
    echo "üóëÔ∏è  –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –±–∞–∑—É dev.db..."
    rm dev.db
fi

if [ -f "production.db" ]; then
    echo "üóëÔ∏è  –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –±–∞–∑—É production.db..."
    rm production.db
fi

# –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è SQLite
echo "üî® –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π –¥–ª—è SQLite..."
npx prisma migrate dev --name init_sqlite

# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º Prisma Client
echo "‚öôÔ∏è  –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client..."
npx prisma generate

# –ó–∞–ø–æ–ª–Ω—è–µ–º –±–∞–∑—É –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
echo "üå± –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö..."
npm run prisma:seed

echo "‚úÖ SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞!"
echo ""
echo "üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞: dev.db"
echo "üë§ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä: admin@example.com / admin123"
echo ""
echo "üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä: npm run dev"
